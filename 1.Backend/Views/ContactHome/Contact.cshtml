@model PT.UI.Models.ContactHomeModel
@addTagHelper *, PT.UI
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer  Localizer
@inject Microsoft.Extensions.Options.IOptions<List<WebsiteInfoSettings>> websiteInfoSettings
@inject Microsoft.Extensions.Options.IOptions<AuthorizeSettings> _authorizeSettings;
@{
    Layout = "~/Views/Shared/_Home.cshtml";
    string language = PT.Base.CultureHelper.GetCurrentCulture.Id;
    var websiteInfoSetting = websiteInfoSettings.Value.FirstOrDefault(x => x.Id == language) ?? new WebsiteInfoSettings();
}
<div class="page-content">
    <!--section-->
    <div class="section mt-0">
        <div class="breadcrumbs-wrap">
            <div class="container">
                <div class="breadcrumbs">
                    <a href="/">@Localizer["Home"].Value</a>
                    <span>@Localizer["Contact"].Value</span>
                </div>
            </div>
        </div>
    </div>

    @Html.Raw(websiteInfoSetting.Map)
    <!--//section-->
    <div class="section page-content-first" style="margin-top:50px;">
        <div class="container">
            <div class="row">
                <div class="col-md col-lg-6">
                    <div class="pr-0 pr-lg-2">
                        @if (language == "vi")
                        {
                            <vc:view-module id="1026" type="StaticInformation"></vc:view-module>
                        }
                        else if (language == "en")
                        {
                            <vc:view-module id="1027" type="StaticInformation"></vc:view-module>
                        }
                    </div>
                </div>
                <div class="col-md col-lg-6" >
                    <form class="contact-form" form-contact>
                        <input type="hidden" asp-for="Language" />
                        @Html.AntiForgeryToken()
                        <div class="successform" style="display:none;">
                            <p>@Localizer["MsgSuccess"].Value</p>
                        </div>
                        <div class="errorformhide" style="display:none;">
                            <p>@Localizer["MsgError"].Value</p>
                        </div>
                        <div style="position: relative;">
                            <div class="input-group mt-1">
                                <span>
                                    <i class="icon-user"></i>
                                </span>
                                <input type="text" asp-for="FullName" class="form-control" placeholder="@Html.DisplayNameFor(x=>x.FullName)*">
                                <span asp-validation-for="FullName"></span>
                            </div>
                        </div>
                        <div class="mt-15" style="position: relative;">
                            <div class="input-group mt-1">
                                <span>
                                    <i class="icon-email2"></i>
                                </span>
                                <input type="text" asp-for="Email" class="form-control" autocomplete="off" placeholder="@Html.DisplayNameFor(x=>x.Email)*">
                                <span asp-validation-for="Email"></span>
                            </div>
                        </div>
                        <div class="mt-15" style="position: relative;">
                            <select id="mySelect2" asp-items="Model.CountrySelectlist" class="form-control" asp-for="CountryId">
                                <option value="">@Localizer["Select Country"] *</option>
                            </select>
                            <span asp-validation-for="CountryId"></span>
                        </div>

                        <div class="mt-15" style="position: relative;">
                            <div class="input-group">
                                <span>
                                    <i class="icon-smartphone"></i>
                                </span>
                                <input type="text" readonly style="max-width: 80px !important; background-color: #9e9e9e1f;" asp-for="PhoneCode" class="form-control" autocomplete="off" placeholder="+">
                                <input type="text" asp-for="Phone" class="form-control" autocomplete="off" placeholder="@Html.DisplayNameFor(x=>x.Phone)">
                                <span asp-validation-for="Phone"></span>
                            </div>
                        </div>
                        <div class="mt-15" style="position: relative;">
                            <textarea class="form-control" asp-for="Content" placeholder="@Html.DisplayNameFor(x=>x.Content)*"></textarea>
                            <span asp-validation-for="Content"></span>
                        </div>
                        <div class="mt-3">
                            <input type="hidden" asp-for="Capcha" />
                            <button  btn-send-contact type="button" class="btn"><i class="icon-right-arrow"></i><span>@Localizer["Send message"].Value</span><i class="icon-right-arrow"></i></button>
                        </div>
                    </form>
                    @*<div class="link-drop">
                            <h5 class="link-drop-title title-home-index"><i class="icon-clock icon-template"></i>@SR["Working Time"]</h5>
                            <table class="row-table table-lich">
                                <tr>
                                    <td><i>@SR["Mon-Friday"]</i></td>
                                    <td>08:00 - 19:00</td>
                                </tr>
                                <tr>
                                    <td><i>@SR["Friday"]</i></td>
                                    <td> 07:00 - 21:00</td>
                                </tr>
                                <tr>
                                    <td><i>@SR["Saturday"]</i></td>
                                    <td>08:00 - 18:00</td>
                                </tr>
                                <tr>
                                    <td><i>@SR["Sunday"]</i></td>
                                    <td>@SR["Closed"]</td>
                                </tr>
                            </table>
                        </div>*@
                </div>
            </div>
        </div>
    </div>
    <div style="height:70px;">
    </div>


    <!--//section-->
</div>
@section Scripts
{
    <script src="~/Content/Admin/js/jquery.validate.min.js"></script>
    <script src="~/Content/Admin/js/jquery.validate.unobtrusive.min.js"></script>

    <script>

        var arrayList = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(ViewData["dataCountry"]));
        $('#mySelect2').select2({
          selectOnClose: true
        });
        $('#mySelect2').on("change", function () {

            if ($('#mySelect2').val() == "") {
                $("#PhoneCode").val("");
            }
            else {
                var dl = arrayList.find(x => x.Id == $('#mySelect2').val());
                if (dl != null) {
                    $("#PhoneCode").val(dl.PhoneCode);
                }
            }
        });

        $(document).on("click", "[btn-send-contact]", function () {
            initCapcha(function () {
                var form = $("[form-contact]");
                if (form.valid()) {
                    $.ajax({
                        type: "POST",
                        url: "",
                        data: form.serialize(),
                        headers:
                        {
                            "RequestVerificationToken": form.find("input[name='__RequestVerificationToken']").val()
                        },
                        success: function (rs) {
                            if (rs.output == 1) {
                                $("[name='FullName']").val("");
                                $("[name='Email']").val("");
                                $("[name='Phone']").val("");
                                $("[name='Content']").val("");
                                $("#Capcha").val("");
                                $(".successform").show();
                                $(".errorformhide").hide();
                            }
                            else {
                                $("[name='FullName']").val("");
                                $("[name='Email']").val("");
                                $("[name='Phone']").val("");
                                $("[name='Content']").val("");
                                $("#Capcha").val("");
                                $(".errorformhide").show();
                                $(".successform").hide();
                                $(".errorformhide p").html(rs.message);
                            }
                        },
                        error: function () {
                            alert("Vui lòng F5 trình duyệt rồi thử lại!");
                        },
                        complete: function (jqxhr, txt_status) {
                            if (jqxhr.status == 502) {
                                alertify.notify("Phiên làm việc đã kết thúc F5 trình duyệt rồi thử lại.", "warning", 5);
                            }
                        }
                    });
                }
            });
            
        });
    </script>
}
